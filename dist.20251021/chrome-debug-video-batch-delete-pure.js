(()=>{async function o(o,e,n){try{const n=`AppMsgId=${o}&token=${e}&lang=zh_CN&f=json&ajax=1`,t=await fetch("https://mp.weixin.qq.com/cgi-bin/operate_appmsg?sub=del&t=ajax-response",{body:n,method:"POST"}),l=await t.json();return console.log(`处理 ID: ${o} 的结果：`),console.log(l),l}catch(e){throw console.error(`处理 ID: ${o} 时发生错误：`),console.error(e),e}}!async function(){try{const e=window.location.href;console.log(`使用当前页面URL作为Referer: ${e}`);const n=function(o,e){if(!o||!e)return null;const n=o.split("?")[1];if(!n)return null;const t=n.split("&");for(const o of t){const[n,t]=o.split("=");if(n===e)return t}return null}(e,"token");if(!n)return void console.error("无法从当前页面URL中提取token，请确保在包含token参数的页面上运行此代码");if(console.log(`从当前页面提取到token: ${n}`),!(wx&&wx.cgiData&&wx.cgiData.item&&Array.isArray(wx.cgiData.item)))return void console.error("未找到有效的wx.cgiData.item数据");const t=wx.cgiData.item.filter(o=>o&&o.app_id).map(o=>({appId:o.app_id,title:o.title||"未知标题"}));if(0===t.length)return void console.log("没有找到可处理的文章数据");let l;if(console.log(`共发现 ${t.length} 篇文章待处理：`),t.forEach((o,e)=>{console.log(`${e+1}. ID: ${o.appId}，标题: ${o.title}`)}),1===t.length)l=confirm(`是否删除这篇文章？\nID: ${t[0].appId}\n标题: ${t[0].title}`)?"1":"0";else{const o=`共发现 ${t.length} 篇文章，选择处理方式：\n0 - 取消操作\n1 - 逐个确认删除\n2 - 全部删除`;l=prompt(o,"0")}switch(l){case"0":return void console.log("已取消所有操作");case"1":console.log("开始逐个确认删除...");for(const l of t){confirm(`是否删除这篇文章？\nID: ${l.appId}\n标题: ${l.title}`)?(await o(l.appId,n,e),await new Promise(o=>setTimeout(o,1e3))):console.log(`已跳过 ID: ${l.appId} 的文章`)}console.log("逐个处理完成");break;case"2":if(confirm(`确定要删除全部 ${t.length} 篇文章吗？此操作不可恢复！`)){console.log("开始批量删除所有文章...");for(const l of t)console.log(`正在删除 ID: ${l.appId}`),await o(l.appId,n,e),await new Promise(o=>setTimeout(o,1e3));console.log(`全部 ${t.length} 篇文章删除操作已执行完成`)}else console.log("已取消全部删除操作");break;default:return void console.log("无效输入，已取消操作")}}catch(o){console.error("批量处理过程中发生错误："),console.error(o)}}(),module.exports={}})();