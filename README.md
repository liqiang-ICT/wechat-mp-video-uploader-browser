# 微信公众号视频批量上传工具

# 微信公众号自动化工具集

本项目包含两个强大的微信公众号自动化工具，帮助您更高效地管理微信公众号后台操作：

1. **微信公众号自动控制器** (`wechat-mp-puppeteer-controller.js`)：智能页面监测与脚本注入工具
2. **微信视频自动上传器** (`wechat-video-uploader.js`)：视频批量上传专用工具

## 功能特性

### 微信公众号自动控制器

- 📹 **视频素材批量上传**：自动监测视频素材管理页面并注入批量上传工具
- 👥 **用户批量打标签**：自动监测用户管理页面并注入批量打标签工具
- 🔄 **自动页面监测**：实时监控页面URL变化，智能识别不同功能页面
- 📊 **完整日志记录**：所有操作都有详细的日志记录，方便问题排查
- 💻 **友好的用户界面**：在浏览器中显示操作面板，提供状态信息和快捷操作
- 🚀 **跨平台兼容**：支持Windows、macOS和Linux系统

### 微信视频自动上传器

- 🎥 **批量视频上传**：从指定目录自动批量上传视频文件
- 📝 **自动标题填写**：使用文件名自动填写视频标题
- 🔄 **失败重试机制**：上传失败时自动重试，提高成功率
- 📋 **失败记录**：记录上传失败的视频，便于后续处理
- ⏱️ **间隔控制**：可配置上传间隔，避免触发频率限制

## 环境要求

- **Node.js** (v12.0或更高版本)
- **npm** 或 **yarn** 包管理器
- **Google Chrome** 浏览器
- **微信公众号** 账号（需要有素材管理和用户管理权限）

## 安装依赖

打开终端，进入项目目录，执行以下命令安装必要的依赖包：

```bash
npm install
```

## 微信公众号自动控制器使用说明

### 1. 准备工作

- 确保`chrome-debug-uploader.js`和`chrome-debug-tag.js`文件存在于项目目录中
- 准备视频文件（程序会提示您指定视频目录）

### 2. 运行程序

```bash
node wechat-mp-puppeteer-controller.js
```

### 3. 使用流程

1. **指定视频目录**：程序启动后，会提示您输入视频文件所在目录，直接按Enter使用默认目录
2. **扫码登录**：程序会自动打开Chrome浏览器并导航到微信公众号登录页面，请扫码登录
3. **自动监测**：登录成功后，程序会在浏览器左上角显示操作面板，并开始监测页面URL变化
4. **功能使用**：
   - 导航到**视频素材管理页**：程序会自动注入批量上传工具并创建"批量上传视频"按钮
   - 导航到**用户管理页**：程序会自动注入批量打标签工具并创建"批量打标签"按钮
5. **执行操作**：点击页面中出现的相应按钮开始执行操作
6. **退出程序**：操作完成后，在终端中按Enter键退出程序

## 微信视频自动上传器使用说明

### 1. 准备工作

在`articles-videos`目录中放入要上传的视频文件

支持的视频格式：mp4, mov, avi, flv, wmv, mkv

### 2. 运行脚本

```bash
node wechat-video-uploader.js
```

### 3. 使用流程

1. **扫码登录**：在打开的浏览器中扫码登录微信公众号
2. **自动上传**：脚本会自动开始上传视频文件
3. **上传完成**：上传完成后，可以查看上传结果和失败记录

## 配置说明

### 微信公众号自动控制器配置

您可以在 `wechat-mp-puppeteer-controller.js` 文件中修改以下配置参数：

```javascript
const config = {
    headless: false, // 是否无头模式，开发阶段设为false便于调试
    delayBetweenActions: 3000, // 操作间隔时间(毫秒)
    maxRetries: 3, // 失败重试次数
    timeout: 60000, // 操作超时时间(毫秒)
    videoDirectory: '', // 视频目录，程序运行时会提示输入
    logFile: path.join(__dirname, 'wechat-mp-auto-controller.log') // 日志文件路径
};
```

### 微信视频自动上传器配置

您可以在 `wechat-video-uploader.js` 文件中修改以下配置参数：

- `videoDir`: 视频文件目录，默认为`./articles-videos`
- `headless`: 是否无头模式，开发阶段设为`false`便于调试
- `delayBetweenUploads`: 上传间隔时间(毫秒)，避免触发频率限制，默认为30000毫秒
- `maxRetries`: 失败重试次数，默认为3次

## 页面功能识别

### 微信公众号自动控制器会自动识别以下页面：

- **视频素材管理页**：URL包含 `cgi-bin/appmsg` 和 `action=list_video`
- **用户管理页**：URL包含 `cgi-bin/user_tag` 和 `action=get_all_data`
- **登录页**：URL包含 `mp.weixin.qq.com` 和 `cgi-bin/login`
- **素材管理编辑页**：URL包含 `videomsg_edit`

## 操作面板说明

微信公众号自动控制器在浏览器左上角显示的操作面板包含以下内容：

- **标题**：微信公众号自动控制器
- **状态信息**：显示当前程序运行状态
- **视频目录信息**：显示当前使用的视频文件目录
- **操作按钮**：
  - **刷新页面**：重新加载当前页面
  - **帮助**：显示使用说明

## 日志记录

### 微信公众号自动控制器日志

- 普通日志：保存在 `wechat-mp-auto-controller.log`
- 错误日志：保存在 `error.log`（仅在发生错误时创建）

### 微信视频自动上传器日志

- 上传失败记录：保存在 `upload-failures.txt`

## 注意事项

1. 请确保您有微信公众号的运营权限
2. 上传视频的大小和时长需要符合微信公众号的规定
3. 运行程序时，请保持网络连接稳定
4. 请勿在程序运行过程中关闭浏览器或终端窗口
5. 使用此工具时，请遵守微信公众平台的相关规定
6. 建议在操作前备份重要数据

## 常见问题及解决方案

### 1. 程序无法启动浏览器

- 确保您已安装Google Chrome浏览器
- 检查Chrome安装路径是否正确
- 尝试以管理员权限运行程序

### 2. 登录后程序无法识别页面

- 确保您的微信公众号账号有相应的管理权限
- 尝试手动刷新页面
- 检查网络连接是否正常

### 3. 脚本注入失败（微信公众号自动控制器）

- 确保 `chrome-debug-uploader.js` 和 `chrome-debug-tag.js` 文件存在且完整
- 检查文件路径是否正确
- 尝试刷新页面后重新加载

### 4. 上传过程中出现错误

- 查看相应的日志文件获取详细错误信息
- 检查微信公众号后台是否有相关提示信息
- 确保您的账号权限和网络状态正常

### 5. 上传速度很慢

- 这可能是由于网络原因或微信服务器限制，请耐心等待
- 两个工具都设置了操作间隔时间，避免触发频率限制

## 版本历史

- **v1.0**：初始版本，包含微信视频自动上传器
- **v2.0**：新增微信公众号自动控制器，支持视频批量上传和用户批量打标签功能

## 许可证

本项目仅供学习和研究使用，请勿用于商业用途。

## 免责声明

使用本工具产生的一切后果由使用者自行承担，作者不承担任何责任。请遵守相关法律法规和平台规定。