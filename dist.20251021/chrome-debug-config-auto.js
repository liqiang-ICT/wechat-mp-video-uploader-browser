(()=>{function t(t){const e=document.getElementById("chrome-debug-config-info");e?(e.textContent+="\n"+t,console.log("[配置自动操作]",t)):console.log("[配置自动操作]",t)}function e(t){return new Promise(e=>setTimeout(e,t))}function o(t){for(const e of t){const t=document.querySelector(e);if(t)return console.log(`使用选择器成功找到元素: ${e}`),t}return console.warn(`尝试了 ${t.length} 种选择器都未能找到元素`),null}function n(t,e="元素"){if(!t)return console.error(`${e}不存在，无法点击`),!1;try{return t.click(),console.log(`成功点击 ${e}`),!0}catch(t){return console.error(`点击 ${e} 时出错:`,t),!1}}async function i(n,i=10,a=300){let c=0;for(;c<i;){const l=o(n);if(l)return l;c++,t(`等待元素出现，第${c}/${i}次尝试`),await e(a)}return console.error(`等待元素超时，未找到: ${n.join(", ")}`),null}async function a(){try{t("开始自动配置视频发布设置...");const o=await i(["#title"]);let a="";o?(a=o.value.trim(),t(a?`标题框内容: ${a}`:"标题框为空，无需复制")):t("未找到标题框，无法复制标题内容"),await l("0");const d=await i(["#title"]);d?(d.value=a,t(`已将标题内容复制到新文章: ${a}`)):t("未找到描述框，无法复制标题内容"),await s(),await l("5"),await async function(o){t(`正在根据标题选择视频: ${o}`);const a=[".more-video__list.more-video__list_double"],c=await i(a);if(c){let a=c.querySelectorAll(".more-video__item");for(;0===a.length;)t("视频列表为空，等待加载..."),await e(1e3),a=c.querySelectorAll(".more-video__item");t(`视频列表中找到 ${a.length} 个视频`);for(const e of a){const a=e.querySelector(".more-video__item-title").textContent.trim();if(a.includes(o)){n(e.querySelector(".more-video__item-content"),`标题匹配视频: ${a}`),t(`已选择标题匹配视频: ${a}`);const o=["div.video-select-dialog > div.weui-desktop-dialog__wrp > div > div.weui-desktop-dialog__ft > div > div:nth-child(3) > button"],c=await i(o);c?(n(c,"确认选择视频"),t("已点击确认选择视频")):t("未找到确认按钮，无法点击");break}}t("未找到匹配标题的视频")}else t("未找到视频列表，无法根据标题选择视频")}(a),await c(),await r(),await s(),t("视频发布配置已自动完成！"),window._configAutoCompleted=!0}catch(e){console.error("自动配置过程中出错:",e),t(`配置过程出错: ${e.message}`)}}async function c(){t("正在处理留言配置...");const e=await i([".setting-group__switch-tips_default"]);if(e){n(e,"留言配置按钮");const o=[".interaction-dialog__footer .weui-desktop-btn_primary"],a=await i(o);a&&(n(a,"留言配置确认按钮"),t("留言配置已成功开启"))}}async function l(e="0"){t(`正在点击"${e}"替换按钮...`);const o=[`li[data-type="${e}"]`],a=[".js_replace_pop.pos_left_top .btn.btn_primary.jsPopoverBt"],c=await i([".weui-desktop-icon-btn__exchange"]);c?(n(c,'"替换"按钮'),t('已点击"替换"按钮')):t('未找到"替换"按钮，无法点击');const l=await i(o);if(l){n(l,`"${e}"替换按钮`),t(`已点击"${e}"替换按钮`);const o=await i(a);o?(n(o,'"确认"按钮'),t('已点击"确认"按钮')):t('未找到"确认"按钮，无法点击')}else t(`未找到"${e}"替换按钮，无法点击`)}async function r(){t("正在处理内容声明...");const e=await i(['input[data-label="内容由AI生成"]']);e&&(n(e,"内容来自AI选项"),t('内容声明已设置为"内容来自AI"'))}async function s(){t("正在保存配置...");const o=await i(["#js_submit button"]);if(o){for(n(o,"保存按钮"),t("已点击保存按钮"),t("等待保存操作完成..."),await e(1e3);o.disabled;)await e(1e3),t("保存ing...");t("保存操作已完成")}}async function d(){!function(){const t=window.location.href;return t.includes("mp.weixin.qq.com")&&t.includes("cgi-bin/appmsg")&&t.includes("t=media/appmsg_edit_v2")&&t.includes("action=edit")}()?console.log("当前页面不是视频配置页面，脚本将不会执行"):(!function(){if(document.getElementById("chrome-debug-config-info"))return;const t=document.createElement("div");t.id="chrome-debug-config-info",t.style.position="fixed",t.style.top="10px",t.style.right="10px",t.style.zIndex="10000",t.style.backgroundColor="#f5f5f5",t.style.border="2px solid #4CAF50",t.style.borderRadius="4px",t.style.padding="10px",t.style.minWidth="300px",t.style.maxHeight="400px",t.style.overflow="auto",t.style.fontSize="12px",t.style.whiteSpace="pre-wrap",t.style.fontFamily="monospace",t.style.color="#333",t.textContent="视频配置自动操作脚本已加载，准备开始自动配置...",document.body.appendChild(t)}(),window.chromeDebugConfigAutoInjected=!0,await a())}console.log("微信公众号视频配置自动操作脚本已加载"),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",d):d(),window.WechatVideoAutoConfig={init:d,autoConfigureVideoPublish:a,handleCommentConfig:c,handleContentDeclaration:r,handleSave:s},module.exports={}})();