(()=>{var t={878:(t,e,n)=>{const r=n(896),o=n(928),c=o.join(__dirname,"accounts-data.json");e.initAccountManager=()=>{r.existsSync(c)||r.writeFileSync(c,JSON.stringify([]),"utf8")},e.getAllAccounts=()=>{try{const t=r.readFileSync(c,"utf8");return JSON.parse(t)}catch(t){return console.error(`读取账号数据失败: ${t.message}`),[]}},e.getAccountById=t=>e.getAllAccounts().find(e=>e.id===t)||null,e.addAccount=t=>{try{const n=e.getAllAccounts();return t.id=t.id||`account_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,t.lastLogin=(new Date).toISOString(),n.push(t),r.writeFileSync(c,JSON.stringify(n,null,2),"utf8"),!0}catch(t){return console.error(`添加账号失败: ${t.message}`),!1}},e.updateAccount=(t,n)=>{try{const o=e.getAllAccounts(),a=o.findIndex(e=>e.id===t);return-1!==a&&(o[a]={...o[a],...n},r.writeFileSync(c,JSON.stringify(o,null,2),"utf8"),!0)}catch(t){return console.error(`更新账号信息失败: ${t.message}`),!1}},e.updateAccountLastLogin=t=>e.updateAccount(t,{lastLogin:(new Date).toISOString()}),e.deleteAccount=t=>{try{const n=e.getAllAccounts(),o=n.filter(e=>e.id!==t);return n.length!==o.length&&(r.writeFileSync(c,JSON.stringify(o,null,2),"utf8"),!0)}catch(t){return console.error(`删除账号失败: ${t.message}`),!1}},e.createUserDataDir=t=>{const e=o.join(__dirname,"user-data"),n=o.join(e,t);return r.existsSync(n)||r.mkdirSync(n,{recursive:!0}),n},e.getAccountInfoFromPage=async t=>{try{return await t.evaluate(()=>{let t="未知公众号",e="unknown",n="";const r=document.querySelectorAll(".weui-desktop-person_info .weui-desktop_name, .account_box-body .acount_box-nickname");if(r.length>0)for(const e of r)if(e.textContent&&e.textContent.trim()){t=e.textContent.trim();break}try{e=wx.data.user_name}catch(t){console.error(`获取微信ID失败: ${t.message}`)}const o=document.querySelectorAll(".weui-desktop-person_info .weui-desktop-account__img, .account_box-body .weui-desktop-account__thumb");if(o.length>0)for(const t of o){const e=t.src||"";if(e&&e.includes("http")&&!e.includes("default_avatar")&&!e.includes("placeholder")){n=e;break}}return{name:t,wechatId:e,avatar:n}})}catch(t){return console.error(`从页面获取账号信息失败: ${t.message}`),{name:"未知公众号",wechatId:"unknown",avatar:""}}},e.initAccountManager()},896:t=>{"use strict";t.exports=require("fs")},928:t=>{"use strict";t.exports=require("path")}},e={};var n=function n(r){var o=e[r];if(void 0!==o)return o.exports;var c=e[r]={exports:{}};return t[r](c,c.exports,n),c.exports}(878);module.exports=n})();